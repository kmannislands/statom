<!DOCTYPE html>
<html class="">
    <head>
        <title>mle | RDocumentation</title>
        <base href="https://www.rdocumentation.org">
        <!-- Viewport mobile tag for sensible mobile support -->
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta http-equiv=Content-Type content=text/html; charset="UTF-8">
        <meta name="description" content="
  Estimate parameters by the method of maximum likelihood.
" />
        <link href="/packages/stats4/versions/3.3.2/topics/mle" rel="canonical" />
        <!--STYLES-->
        <link rel="stylesheet" href="/min/production.min.27248fc474969519859c0eeef2eeed01.css">
        <!--STYLES END-->
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
        <link rel="stylesheet" href='/css/nv.d3.min.css'>
        <link rel="stylesheet" href='https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.7.1/jquery.modal.min.css'>
        <link href = "https://code.jquery.com/ui/1.12.0-rc.2/themes/smoothness/jquery-ui.css" rel = "stylesheet">
        <script src="https://www.google.com/recaptcha/api.js" async defer></script>
        <script type="text/javascript">
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t
            <analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
      analytics.load("trNTMcIUrXKRPdzsdff62NUeZKUzFXLK");
      analytics.page();
      }}();

            </script>
        </head>
        <body>
            <div id="content">
                <div class="page-wrap">
                    <section class="navbar navbar-color navbar-fixed-top">
                        <nav class="clearfix">
                            <div class="navbar--title">
                                <a href="/">
                                    <div class="logo"></div>
                                    <div class="logo-title">
                                        <span>RDocumentation</span>
                                    </div>
                                </a>
                            </div>
                            <ul class="navbar--navigation largescreen">
                                <li>
                                    <a href="https://github.com/datacamp/Rdocumentation" class="btn btn-secondary">R package</a>
                                </li>
                                <li>
                                    <a href="/trends" class="btn btn-secondary">Leaderboard</a>
                                </li>
                                <li>
                                    <a href="/login?rdr=%2Fpackages%2Fstats4%2Fversions%2F3.3.2%2Ftopics%2Fmle" class="btn btn-primary">Sign in</a>
                                </li>
                            </ul>
                            <div class="navbar--search">
                                <form class="search" action="/search" method="get">
                                    <input name="q" id = "searchbar" type="text" placeholder="Search for packages, functions, etc" autocomplete="off">
                                    <div class="search--results"></div>
                                </form>
                            </div>
                        </nav>
                    </section>
                    <section class="topic packageData"
  data-package-name="stats4"
  data-latest-version="3.3.2" >
                        <header class='topic-header'>
                            <div class="container">
                                <div class="th--flex-position">
                                    <div>
                                        <!-- Do not remove this div, needed for th-flex-position -->
                                        <h1>mle</h1>
                                    </div>
                                    <div>
                                        <!-- Do not remove this div, needed for th-flex-position -->
                                        <div class="th--pkg-info">
                                            <div class="th--origin">
                                                <span>From
                                                    <a href="/packages/stats4/versions/3.3.2">stats4 v3.3.2</a>
                                                </span>
                                                <span>by
                                                    <a href="/collaborators/name/R-core R-core@R-project.org">R-core R-core@R-project.org</a>
                                                </span>
                                            </div>
                                            <div class="th--percentile">
                                                <div class="percentile-widget percentile-task" data-url="/api/packages/stats4/percentile">
                                                    <span class="percentile-th">
                                                        <span class='percentile'>0th</span>
                                                    </span>
                                                    <p>Percentile</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </header>
                        <div class="container">
                            <section>
                                <h5>Maximum Likelihood Estimation</h5>
                                <p>
  Estimate parameters by the method of maximum likelihood.
</p>
                            </section>
                            <section class="topic--keywords">
                                <dl>
                                    <dt>Keywords</dt>
                                    <dd>
                                        <a href="/search/keywords/models">models</a>
                                    </dd>
                                </dl>
                            </section>
                            <section>
                                <h5 class="topic--title">Usage</h5>
                                <pre>
                                    <code class="R">
                                        <div>mle(minuslogl, start&nbsp;=&nbsp;formals(minuslogl), method&nbsp;=&nbsp;"BFGS", fixed&nbsp;=&nbsp;list(), nobs, ...)</div>
                                    </code>
                                </pre>
                            </section>
                            <section class="topic--arguments">
                                <h5 class="topic--title">Arguments</h5>
                                <dl>
                                    <dt>minuslogl</dt>
                                    <dd>Function to calculate negative log-likelihood.</dd>
                                    <dt>start</dt>
                                    <dd>Named list. Initial values for optimizer.</dd>
                                    <dt>method</dt>
                                    <dd>Optimization method to use. See
                                        <code>
                                            <a rd-options="" href="/link/optim?package=stats4&version=3.3.2">optim</a>
                                        </code>.
                                    </dd>
                                    <dt>fixed</dt>
                                    <dd>Named list.  Parameter values to keep fixed during
    optimization.</dd>
                                    <dt>nobs</dt>
                                    <dd>optional integer: the number of observations, to be used for
    e.g.\ifelse{latex}{\out{~}}{ } computing
                                        <code>
                                            <a rd-options="" href="/link/BIC?package=stats4&version=3.3.2">BIC</a>
                                        </code>.
                                    </dd>
                                    <dt>...</dt>
                                    <dd>Further arguments to pass to
                                        <code>
                                            <a rd-options="" href="/link/optim?package=stats4&version=3.3.2">optim</a>
                                        </code>.
                                    </dd>
                                </dl>
                            </section>
                            <!-- Other info -->
                            <section>
                                <h5 class="topic--title">Details</h5>
                                <p>
  The
                                    <code>
                                        <a rd-options="" href="/link/optim?package=stats4&version=3.3.2">optim</a>
                                    </code> optimizer is used to find the minimum of the
  negative log-likelihood.  An approximate covariance matrix for the
  parameters is obtained by inverting the Hessian matrix at the optimum.
                                </p>
                            </section>
                            <section class="topic--value">
                                <h5 class="topic--title">Value</h5>
                                <p>
                                    <dl>
  An object of class
                                        <code>
                                            <a rd-options="" href="/link/mle-class?package=stats4&version=3.3.2">mle-class</a>
                                        </code>.
                                    </dl>
                                </p>
                            </section>
                            <section>
                                <h5 class="topic--title">Note</h5>
                                <p>
  Be careful to note that the argument is -log L (not -2 log L). It
  is for the user to ensure that the likelihood is correct, and that
  asymptotic likelihood inference is valid.
</p>
                            </section>
                            <section>
                                <h5 class="topic--title">See Also</h5>
                                <p>
                                    <code>
                                        <a rd-options="" href="/link/mle-class?package=stats4&version=3.3.2">mle-class</a>
                                    </code>
                                </p>
                            </section>
                            <section style="display: none;">
                                <h5 class="topic--title">Aliases</h5>
                                <ul class="topic--aliases">
                                    <li>mle</li>
                                </ul>
                            </section>
                            <section>
                                <h5 class="topic--title">Examples</h5>
                                <pre>
                                    <code class="nohighlight R exampleR" data-package-name = stats4>## Avoid printing to unwarranted accuracy
od &lt;- options(digits = 5)
x &lt;- 0:10
y &lt;- c(26, 17, 13, 12, 20, 5, 9, 8, 5, 4, 8)

## Easy one-dimensional MLE:
nLL &lt;- function(lambda) -sum(stats::dpois(y, lambda, log = TRUE))
fit0 &lt;- mle(nLL, start = list(lambda = 5), nobs = NROW(y))
# For 1D, this is preferable:
fit1 &lt;- mle(nLL, start = list(lambda = 5), nobs = NROW(y),
            method = &quot;Brent&quot;, lower = 1, upper = 20)
stopifnot(nobs(fit0) == length(y))

## This needs a constrained parameter space: most methods will accept NA
ll &lt;- function(ymax = 15, xhalf = 6) {
    if(ymax &gt; 0 &amp;&amp; xhalf &gt; 0)
      -sum(stats::dpois(y, lambda = ymax/(1+x/xhalf), log = TRUE))
    else NA
}
(fit &lt;- mle(ll, nobs = length(y)))
mle(ll, fixed = list(xhalf = 6))
## alternative using bounds on optimization
ll2 &lt;- function(ymax = 15, xhalf = 6)
    -sum(stats::dpois(y, lambda = ymax/(1+x/xhalf), log = TRUE))
mle(ll2, method = &quot;L-BFGS-B&quot;, lower = rep(0, 2))

AIC(fit)
BIC(fit)

summary(fit)
logLik(fit)
vcov(fit)
plot(profile(fit), absVal = FALSE)
confint(fit)

## Use bounded optimization
## The lower bounds are really &gt; 0,
## but we use &gt;=0 to stress-test profiling
(fit2 &lt;- mle(ll, method = &quot;L-BFGS-B&quot;, lower = c(0, 0)))
plot(profile(fit2), absVal = FALSE)

## a better parametrization:
ll3 &lt;- function(lymax = log(15), lxhalf = log(6))
    -sum(stats::dpois(y, lambda = exp(lymax)/(1+x/exp(lxhalf)), log = TRUE))
(fit3 &lt;- mle(ll3))
plot(profile(fit3), absVal = FALSE)
exp(confint(fit3))

options(od)
</code>
                                </pre>
                            </section>
                            <small>
                                <i> Documentation reproduced from package
                                    <span itemprop="name">stats4</span>, version
                                    <span itemprop="version">3.3.2</span>,
        License: Part of R 3.3.2
                                </i>
                            </small>
                            <div class='user-examples' id="postExample">
                                <h3>Community examples</h3>
                                <div class="example-content">
                                    <div class="example--placeholder">Looks like there are no examples yet.</div>
                                </div>
                                <div class="example--form">
                                    <div class="example--form-body">
                                        <form method="post" action='/api/topics/7503355/examples'>
                                            <fieldset class="example--form-text">
                                                <label for="text">
                                                    <h3 id="postExampleTitle">Post a new example:</h3>
                                                </label>
                                                <textarea name='text' rows="4" id="postExampleText"></textarea>
                                            </fieldset>
                                            <fieldset>
                                                <a id="openModalExample" href="/modalLogin" rel = "modal:open">
                                                    <button class="btn btn-primary pull-right" type="button">Submit your example</button>
                                                </a>
                                            </fieldset>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="footer">
                    <a class="navbar--title apidoc btn btn-default js-external" target="_blank" href="/docs">
                        <i class="fa fa-cogs"></i>
      API documentation
                    </a>
                    <div class="navbar--title footer-largescreen pull-right">
                        <a href=https://github.com/datacamp/rdocumentation class="js-external">
                            <div class="github"></div>
                            <div class="logo-title">R package</div>
                        </a>
                    </div>
                    <div class="navbar--title footer-largescreen pull-right">
                        <a href = "https://github.com/datacamp/rdocumentation-app" class="js-external">
                            <div class="github"></div>
                            <div class="logo-title">Rdocumentation.org</div>
                        </a>
                    </div>
                    <div class="footer--credits--title">
                        <p class="footer--credits">Created by
                            <a href="https://www.datacamp.com" class="js-external">DataCamp.com</a>
                        </p>
                    </div>
                </div>
            </div>
            <!--TEMPLATES-->
            <!--TEMPLATES END-->
            <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
            <script src = "https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.27.2/js/jquery.tablesorter.min.js"> </script>
            <script src = "https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
            <script src = "https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"> </script>
            <script src = "https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.3/nv.d3.min.js"> </script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.7.1/jquery.modal.min.js"></script>
            <script src = "https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
            <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        messageStyle: "none",
        jax: ["input/TeX","output/CommonHTML"],
        extensions: ["tex2jax.js","MathMenu.js","MathZoom.js"],
        TeX: {
          extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
        },
        tex2jax: {
          inlineMath: [ ['$','$'] ],
          displayMath: [ ['$$','$$'] ],
          processEscapes: true,
          preview: 'none'
        }
      });
    </script>
            <script src = "https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
            <script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
            <script type="text/javascript">
      var $jq = jQuery.noConflict();
    </script>
            <!--SCRIPTS-->
            <script src="/min/production.min.ea80ef6af645bd056354a66d772d7cb0.js"></script>
            <!--SCRIPTS END-->
            <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41577880-1', 'rdocumentation.org');
      ga('send', 'pageview');
    </script>
        </body>
    </html>
